# Node Hybrid JWT + Session Auth API

This is a backend API that uses a hybrid authentication approach combining Express server-side sessions and JWT-based access control, with all credentials stored in HTTP-only cookies. This approach ensures security while allowing stateless validation for route access.

## üõ†Ô∏è Setup

Follow these steps to get the project up and running with Prisma and ensure the `prisma/generated` folder is created properly.

1. **Environment Configuration**
    To run the application locally, create a `.env` file in the root directory with the following variables:

    ```env
    # PostgreSQL connection string
    DATABASE_URL=postgresql://admin_pg:password@localhost:5433/local-express-hybrid-auth-api-db

    # Google OAuth configuration
    GOOGLE_CLIENT_ID=your-google-client-id
    GOOGLE_CLIENT_SECRET=your-google-client-secret
    GOOGLE_CALLBACK_URL=http://localhost:3000/auth/google/callback

    # GitHub OAuth configuration
    GITHUB_CLIENT_ID=your-github-client-id
    GITHUB_CLIENT_SECRET=your-github-client-secret
    GITHUB_CALLBACK_URL=http://localhost:3000/auth/github/callback
    ```

1. **Install Dependencies**: Install all required dependencies for the project.
    ```bash
    npm install
    ```

1. **Generate Prisma Client and Artifacts**: Prisma generates the database client and optionally other files (like types or codegen outputs) into the `prisma/generated` folder. To generate everything:
    ```bash
    npx prisma generate
    ```
    This command reads your `schema.prisma` file and creates the necessary output in `node_modules/.prisma` and (if configured) in `prisma/generated`. Re-run this command any time you modify your Prisma schema.

1. **Apply Database Migrations**: If you're using Prisma Migrate and have migrations defined, run:
    ```bash
    npx prisma migrate dev
    ```
    This will:
    - Apply all pending migrations to your local database
    - Generate the Prisma Client
    - Optionally run seed scripts if configured

1. **Open Prisma Studio (Optional)**: Prisma Studio is a visual interface to explore and manipulate your database during development.
    ```bash
    npx prisma studio
    ```
    This opens a browser window where you can browse tables, add records, and debug data visually.

__Notes:__
 * If your project is configured to use the `prisma/generated` folder (e.g., for custom types or GraphQL artifacts), it will be populated by `npx prisma generate`. This folder is typically **auto-generated** and should either be:
    - Ignored in version control (`.gitignore`), or
    - Re-generated by every contributor using the steps above.
    Do **not** manually edit files in `prisma/generated` unless explicitly intended.

  * You can generate a strong __SESSION_SECRET__ using the following command in your terminal (Unix/macOS/Linux):`openssl rand -base64 64`. On windows you can use git bash. Then add it to your _.env_ file for production use:
    
    ```
    SESSION_SECRET=your_generated_value_here
    ```
# Resources
- [Lucia Auth](https://lucia-auth.com/) This website provides valuable resources for understanding and implementing authentication in JavaScript and TypeScript. Special thanks to [pilcrowonpaper](https://github.com/pilcrowonpaper) for the clear and well-documented content.
- [How To Set Up a Node Project With Typescript](https://www.digitalocean.com/community/tutorials/setting-up-a-node-project-with-typescript)
- [How to Setup a TypeScript + Node.js Project](https://khalilstemmler.com/blogs/typescript/node-starter-project/)
- [Creating a basic REST API with TypeScript, Node.js, Swagger MVC](https://blog.devgenius.io/creating-a-basic-rest-api-with-typescript-node-js-swagger-mvc-42852ae5b52f)
- [OpenAPI React Query Codegen](https://openapi-react-query-codegen.vercel.app/examples/nextjs/)
